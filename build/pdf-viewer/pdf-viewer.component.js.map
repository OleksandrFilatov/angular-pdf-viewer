{"version":3,"sources":["pdf-viewer/pdf-viewer.component.ts"],"names":[],"mappings":"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","file":"pdf-viewer/pdf-viewer.component.js","sourcesContent":["/**\n * Created by vadimdez on 21/06/16.\n */\nimport { Component, Input, ElementRef } from '@angular/core';\nimport PDFJS from 'pdfjs-dist';\n\n@Component({\n  selector: 'pdf-viewer',\n  template: '<div class=\"ng2-pdf-viewer-container\"></div>'\n})\n\nexport class PdfViewerComponent {\n  private _showAll: boolean = false;\n  private _originalSize: boolean = false;\n  private _src: string;\n  private _pdf: any;\n  private _page: number = 1;\n\n  constructor(private element: ElementRef) {}\n\n  @Input()\n  set src(_src) {\n    this._src = _src;\n\n    this.fn();\n  }\n\n  @Input()\n  set page(_page) {\n    _page = parseInt(_page, 10);\n\n    if (this._pdf && this.isValidPageNumber(_page)) {\n      this._page = _page;\n      this.renderPage(_page);\n    }\n  }\n\n  @Input('original-size')\n  set originalSize(originalSize: boolean) {\n    this._originalSize = originalSize;\n\n    if (this._pdf) {\n      this.fn();\n    }\n  }\n\n  @Input('show-all')\n  set showAll(value: boolean) {\n    this._showAll = value;\n\n    if (this._pdf) {\n      this.fn();\n    }\n  }\n\n  private fn() {\n    PDFJS.getDocument(this._src).then((pdf: any) => {\n      this._pdf = pdf;\n\n      if (!this.isValidPageNumber(this._page)) {\n        this._page = 1;\n      }\n\n      if (!this._showAll) {\n        return this.renderPage(this._page);\n      }\n\n      return this.renderMultiplePages();\n    });\n  }\n\n  private renderMultiplePages() {\n    let container = this.element.nativeElement.querySelector('div');\n    let page = 1;\n    const renderPageFn = (page: number) => () => this.renderPage(page);\n\n    this.removeAllChildNodes(container);\n\n    let d = this.renderPage(page++);\n\n    for (page; page <= this._pdf.numPages; page++) {\n      d = d.then(renderPageFn(page));\n    }\n  }\n\n  private isValidPageNumber(page: number) {\n    return this._pdf.numPages >= page && page >= 1;\n  }\n\n  private renderPage(page: number) {\n    return this._pdf.getPage(page).then((page: any) => {\n      let viewport = page.getViewport(1);\n      let container = this.element.nativeElement.querySelector('div');\n      let canvas: HTMLCanvasElement = document.createElement('canvas');\n\n      if (!this._originalSize) {\n        viewport = page.getViewport(this.element.nativeElement.offsetWidth / viewport.width);\n      }\n\n      if (!this._showAll) {\n        this.removeAllChildNodes(container);\n      }\n\n      container.appendChild(canvas);\n\n      canvas.height = viewport.height;\n      canvas.width = viewport.width;\n\n      page.render({\n        canvasContext: canvas.getContext('2d'),\n        viewport: viewport\n      });\n    });\n  }\n\n  private removeAllChildNodes(element: HTMLElement) {\n    while (element.firstChild) {\n      element.removeChild(element.firstChild);\n    }\n  }\n}"],"sourceRoot":"/source/"}